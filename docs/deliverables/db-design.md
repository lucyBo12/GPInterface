# Database Design:

Below will go the design of the database as it evolves through the project.

## Suggest organising like:

- Class
    - attr1, attr2, attr3
    - PK: attr2, attr3
        - Explanation point
    - FK: attr1 ref Table
    - Other constraints
    - Explanation point

- Class2
    - attr1, attr2, attr3
    - PK: attr2, attr3
        - Explanation point
    - FK: attr1 ref Table
    - Other constraints
    - Explanation point

## <--- BEGIN --->

- Doctor
    - did, forename, surname, phoneNumber
    - PK: did
    - phoneNumber is VARCHAR(15) - enough characters and no automatic dialling needed so characters fine

- Patient
    - pid, email, forename, surname, dob, gender, disabilities, doctor
    - PK: pid
    - FK: doctor ref Doctor
    - email unique
        - Because used for login
    - gender in (M, F, O)
    - disabilities is TEXT to be unrestrictive in size

- Login
    - pid, hashed_pass
    - PK: pid
    - FK: pid ref Patient cascade
        - If patient deleted, their login is deleted
    - hashed_pass exact length VARCHAR(64) - SHA-256 hex hash string

- Booking
    - bid, reason, date, time, patient, doctor
    - PK: bid
    - FK: patient ref Patient cascade
        - If patient is deleted, their appointments are deleted
    - FK: doctor ref Doctor
    - Unique: date, patient, doctor
        - Prevents double bookings
            - Assumption: Patient never booked with doctor twice in one day
    - date is DATE
    - time is TIME
    - Above two seperated as used for seperate features

- Message
    - mid, datetime, contains, pid, did
    - PK: mid
    - FK: pid ref Patient cascade
        - If patient is deleted, messages to them are deleted
    - FK: did ref Doctor
    - Check: pid not null or did not null
        - Message must be TO someone
    - datetime is DATETIME
    - contains is TEXT to be unrestrictive in size

- PatientLog
    - lid, datetime, contains
    - PK: lid
    - datetime is DATETIME
    - contains is TEXT to be unrestrictive in size
    - Instead of setting pid as a foreign key, patient details are put in message to avoid complication if the patient is later deleted from the database
        - Text generated by program
    
- General points:
    - All id colummn values are INTs set by a method in the program which takes the largest id in that takes the largest id in the table and adds 1 for new entries
    - All NOT NULL except disabilities, gender in Patient and pid, did in Message
        - Can have no disabilities
        - NULL gender means prefer not to say
        - In Message:
            - If only one of pid or did are set, message is from System to user (doctor or patient)
            - If both are set, message is from doctor to patient
            - Assumption: Patient cannot message doctor directly
    - All forenames are VARCHAR(20) - should be enough characters for a forename
    - All surnames are VARCHAR(40) - should be enough characters for a surname
    - All dob are DATE
    - All gender are CHAR(1) - M, F or O
